---
title: PicoCTF 2018 - Super Safe RSA 2
author: AlphaChaos
date: 2020-11-28 12:00:00 +0000
categories: [PicoCTF_2018]
tags: [basics, picoctf, rsa, tutorial, wiener attack, intermediate]     # TAG names should always be lowercase
---

### Challenge Description

> Wow, he made the exponent really large so the encryption MUST be safe, right?! Connect with nc 2018shell.picoctf.com 29483

### Challenge Hint

> What is the usual value for e?

### Challenge Analysis

So let's look at what information we are given in the challenge.  

OK so other than the name suggesting RSA we really aren't given much to go on, so we might as well connect to the remote server and see what more information we're given.

```terminal
$ nc 2018shell.picoctf.com 29483
c: 75113115143553225885253332123566818827038648234103676192466516226946465524691226952360294827760780901539786834383178566295183524854691985229874954586779384749722587353286539514998508009857883200736961742580679642487619832052346769121532832315704282276575836856253787107383276517263496845217188976247929385700
n: 82921707197701729260599032231375883676413245891057622938545551099711565967717605278874508714000409189096523341744613182770613466875991160710797221637414105109384073761854128914626116159378290454083132613643297893157422171367436273359012220314133127886464802142617767330749859426536051032330427433701418897003
e: 18668992930742771491525988686908939433380799290821295244796673733558816483111422034725321209012863536401104748576251087351883694764106528774399392789722520892380623126151451030720329961140929503981217035595579220123005181688879270964520845366155846162281157000910763068838790811147335379356126180424255884473

```

OK so we have a really unusual value for e. A large e usually means a much smaller d. And a small d value suggests a [wiener attack](https://sagi.io/crypto-classics-wieners-rsa-attack/).

### Challenge Solution

So we just need to code up the attack and see if we can recover d.

```python
# python3 -m pip install owiener

import owiener

c= 75113115143553225885253332123566818827038648234103676192466516226946465524691226952360294827760780901539786834383178566295183524854691985229874954586779384749722587353286539514998508009857883200736961742580679642487619832052346769121532832315704282276575836856253787107383276517263496845217188976247929385700
n= 82921707197701729260599032231375883676413245891057622938545551099711565967717605278874508714000409189096523341744613182770613466875991160710797221637414105109384073761854128914626116159378290454083132613643297893157422171367436273359012220314133127886464802142617767330749859426536051032330427433701418897003
e= 18668992930742771491525988686908939433380799290821295244796673733558816483111422034725321209012863536401104748576251087351883694764106528774399392789722520892380623126151451030720329961140929503981217035595579220123005181688879270964520845366155846162281157000910763068838790811147335379356126180424255884473

d = owiener.attack(e, n)

if d is None:
    print("Failed")
else:
    plaintext = pow(c,d,n)
    flag = bytes.fromhex(hex(plaintext)[2:])
    print (flag.decode())

```

### Flag

`picoCTF{w@tch_y0ur_Xp0n3nt$_c@r3fu11y_7030965}`
